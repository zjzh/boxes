
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>boxes.edges &#8212; boxes.py 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">boxes.py 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../boxes.html" accesskey="U">boxes</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">boxes.edges</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for boxes.edges</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># Copyright (C) 2013-2016 Florian Festi</span>
<span class="c1">#</span>
<span class="c1">#   This program is free software: you can redistribute it and/or modify</span>
<span class="c1">#   it under the terms of the GNU General Public License as published by</span>
<span class="c1">#   the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1">#   (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1">#   This program is distributed in the hope that it will be useful,</span>
<span class="c1">#   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1">#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1">#   GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1">#   You should have received a copy of the GNU General Public License</span>
<span class="c1">#   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">abc</span>

<span class="kn">from</span> <span class="nn">boxes</span> <span class="kn">import</span> <span class="n">gears</span>

<div class="viewcode-block" id="getDescriptions"><a class="viewcode-back" href="../../boxes.html#boxes.edges.getDescriptions">[docs]</a><span class="k">def</span> <span class="nf">getDescriptions</span><span class="p">():</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="n">edge</span><span class="o">.</span><span class="n">char</span><span class="p">:</span> <span class="n">edge</span><span class="o">.</span><span class="n">description</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
         <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="n">BaseEdge</span><span class="p">)</span>
         <span class="ow">and</span> <span class="n">edge</span><span class="o">.</span><span class="n">char</span><span class="p">}</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; (other end)&quot;</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; (other end)&quot;</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; (both ends)&quot;</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; (both ends)&quot;</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (other end)&#39;</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (other end)&#39;</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; top side&#39;</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="sa">u</span><span class="s1">&#39; for 90° lid&#39;</span>
    <span class="n">d</span><span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="sa">u</span><span class="s1">&#39; 90° lid&#39;</span>
    <span class="k">return</span> <span class="n">d</span></div>


<div class="viewcode-block" id="BoltPolicy"><a class="viewcode-back" href="../../boxes.html#boxes.edges.BoltPolicy">[docs]</a><span class="k">class</span> <span class="nc">BoltPolicy</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract class</span>

<span class="sd">    Distributes (bed) bolts on a number of segments</span>
<span class="sd">    (fingers of a finger joint)</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="BoltPolicy.drawbolt"><a class="viewcode-back" href="../../boxes.html#boxes.edges.BoltPolicy.drawbolt">[docs]</a>    <span class="k">def</span> <span class="nf">drawbolt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a bolt to this segment?</span>

<span class="sd">        :param pos: number of the finger</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="BoltPolicy.numFingers"><a class="viewcode-back" href="../../boxes.html#boxes.edges.BoltPolicy.numFingers">[docs]</a>    <span class="k">def</span> <span class="nf">numFingers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numfingers</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return next smaller, possible number of fingers</span>

<span class="sd">        :param numfingers: number of fingers to aim for</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">numfingers</span></div>

    <span class="k">def</span> <span class="nf">_even</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numFingers</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return same or next smaller even number</span>

<span class="sd">        :param numFingers:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">numFingers</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="nf">_odd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numFingers</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return same or next smaller odd number</span>

<span class="sd">        :param numFingers:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">numFingers</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">numFingers</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">numFingers</span> <span class="o">-</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="Bolts"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Bolts">[docs]</a><span class="k">class</span> <span class="nc">Bolts</span><span class="p">(</span><span class="n">BoltPolicy</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Distribute a fixed number of bolts evenly&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bolts</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span> <span class="o">=</span> <span class="n">bolts</span>

<div class="viewcode-block" id="Bolts.numFingers"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Bolts.numFingers">[docs]</a>    <span class="k">def</span> <span class="nf">numFingers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numFingers</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bolts</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fingers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_even</span><span class="p">(</span><span class="n">numFingers</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fingers</span> <span class="o">=</span> <span class="n">numFingers</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fingers</span></div>

<div class="viewcode-block" id="Bolts.drawBolt"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Bolts.drawBolt">[docs]</a>    <span class="k">def</span> <span class="nf">drawBolt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return if this finger needs a bolt</span>

<span class="sd">        :param pos: number of this finger</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">fingers</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fingers</span> <span class="o">-</span> <span class="n">pos</span>

        <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">fingers</span> <span class="o">//</span> <span class="mi">2</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bolts</span> <span class="o">%</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bolts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fingers</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">!=</span>
                  <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bolts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">fingers</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.01</span><span class="p">))</span></div></div>


<span class="c1">#############################################################################</span>
<span class="c1">### Settings</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="Settings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Settings">[docs]</a><span class="k">class</span> <span class="nc">Settings</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generic Settings class</span>

<span class="sd">    Used by different other classes to store messurements and details.</span>
<span class="sd">    Supports absolute values and settings that grow with the thickness</span>
<span class="sd">    of the material used.</span>

<span class="sd">    Overload the absolute_params and relative_params class attributes with</span>
<span class="sd">    the suported keys and default values. The values are available via</span>
<span class="sd">    attribute access.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="Settings.parserArguments"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Settings.parserArguments">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parserArguments</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">defaults</span><span class="p">):</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix</span> <span class="ow">or</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;Settings&quot;</span><span class="p">)]</span>

        <span class="n">lines</span>  <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Parse doc string</span>
        <span class="n">descriptions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^ +\* +(\S+) +: .* : +(.*)&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                <span class="n">descriptions</span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">group</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">group</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">absolute_params</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="o">+</span>
                              <span class="nb">sorted</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">relative_params</span><span class="o">.</span><span class="n">items</span><span class="p">())):</span>
            <span class="c1"># Handle choices</span>
            <span class="n">choices</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">choices</span> <span class="o">=</span> <span class="n">default</span>
                <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">default</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">default</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">t</span> <span class="ow">or</span>
                        <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Type not supported: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                <span class="n">default</span> <span class="o">=</span> <span class="n">default</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># Overwrite default</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">defaults</span><span class="p">:</span>
                <span class="n">default</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">default</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Type not supported: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">default</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">boxes</span> <span class="kn">import</span> <span class="n">BoolArg</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">BoolArg</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

            <span class="n">group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span>
                               <span class="nb">type</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                               <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
                               <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="n">descriptions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">absolute_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Type not supported: </span><span class="si">%r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span> <span class="o">=</span> <span class="n">thickness</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="n">relative</span><span class="p">:</span>
            <span class="n">factor</span> <span class="o">=</span> <span class="n">thickness</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relative_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setValues</span><span class="p">(</span><span class="n">thickness</span><span class="p">,</span> <span class="n">relative</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

<div class="viewcode-block" id="Settings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Settings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate Edge objects using this kind of settings</span>

<span class="sd">        :param boxes: Boxes object</span>
<span class="sd">        :param chars: sequence of chars to be used by Edge objects</span>
<span class="sd">        :param add: add the resulting Edge objects to the Boxes object&#39;s edges</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">edge</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">edges</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">char</span> <span class="o">=</span> <span class="n">chars</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">edge</span><span class="o">.</span><span class="n">char</span> <span class="o">=</span> <span class="n">char</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="n">add</span><span class="p">:</span>
            <span class="n">boxes</span><span class="o">.</span><span class="n">addParts</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">edges</span>

<div class="viewcode-block" id="Settings.setValues"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Settings.setValues">[docs]</a>    <span class="k">def</span> <span class="nf">setValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set values</span>

<span class="sd">        :param thickness: thickness of the material used</span>
<span class="sd">        :param relative:  (Default value = True) Do scale by thickness</span>
<span class="sd">        :param \*\*kw: parameters to set</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="n">relative</span><span class="p">:</span>
            <span class="n">factor</span> <span class="o">=</span> <span class="n">thickness</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kw</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">absolute_params</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relative_params</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">factor</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown parameter for </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkValues</span><span class="p">()</span></div>

<div class="viewcode-block" id="Settings.checkValues"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Settings.checkValues">[docs]</a>    <span class="k">def</span> <span class="nf">checkValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if all values are in the right range. Raise ValueError if needed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span></div>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;values&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span></div>

<span class="c1">#############################################################################</span>
<span class="c1">### Edges</span>
<span class="c1">#############################################################################</span>


<div class="viewcode-block" id="BaseEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.BaseEdge">[docs]</a><span class="k">class</span> <span class="nc">BaseEdge</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract base class for all Edges&quot;&quot;&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Abstract Edge Class&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span> <span class="o">=</span> <span class="n">boxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">ctx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">settings</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hack for using unalter code form Boxes class&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="BaseEdge.__call__"><a class="viewcode-back" href="../../api_edges.html#boxes.edges.BaseEdge.__call__">[docs]</a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="BaseEdge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.BaseEdge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Amount of space the beginning of the edge is set below the inner space of the part &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="BaseEdge.endwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.BaseEdge.endwidth">[docs]</a>    <span class="k">def</span> <span class="nf">endwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">startwidth</span><span class="p">()</span></div>

<div class="viewcode-block" id="BaseEdge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.BaseEdge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Space needed right of the starting point&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="BaseEdge.spacing"><a class="viewcode-back" href="../../boxes.html#boxes.edges.BaseEdge.spacing">[docs]</a>    <span class="k">def</span> <span class="nf">spacing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Space the edge needs outside of the inner space of the part&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">startwidth</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">margin</span><span class="p">()</span></div>

<div class="viewcode-block" id="BaseEdge.startAngle"><a class="viewcode-back" href="../../boxes.html#boxes.edges.BaseEdge.startAngle">[docs]</a>    <span class="k">def</span> <span class="nf">startAngle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Not yet supported&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="BaseEdge.endAngle"><a class="viewcode-back" href="../../boxes.html#boxes.edges.BaseEdge.endAngle">[docs]</a>    <span class="k">def</span> <span class="nf">endAngle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Not yet supported&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">0.0</span></div></div>


<div class="viewcode-block" id="Edge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Edge">[docs]</a><span class="k">class</span> <span class="nc">Edge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Straight edge&quot;&quot;&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;e&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Straight Edge&quot;</span>
    <span class="n">positive</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">bedBolts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bedBoltSettings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Draw edge of length mm&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">bedBolts</span><span class="p">:</span>
            <span class="c1"># distribute the bolts aequidistantly</span>
            <span class="n">interval_length</span> <span class="o">=</span> <span class="n">length</span> <span class="o">/</span> <span class="n">bedBolts</span><span class="o">.</span><span class="n">bolts</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">bedBoltSettings</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bedBoltSettings</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bedBolts</span><span class="o">.</span><span class="n">bolts</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hole</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">interval_length</span><span class="p">,</span>
                              <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">interval_length</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span>
                              <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="n">bedBolts</span><span class="o">.</span><span class="n">bolts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bedBolts</span><span class="o">.</span><span class="n">bolts</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">bedBoltHole</span><span class="p">(</span><span class="n">interval_length</span><span class="p">,</span> <span class="n">bedBoltSettings</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span>
                                     <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="n">bedBolts</span><span class="o">.</span><span class="n">bolts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="OutSetEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.OutSetEdge">[docs]</a><span class="k">class</span> <span class="nc">OutSetEdge</span><span class="p">(</span><span class="n">Edge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Straight edge out set by one thickness&quot;&quot;&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;E&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Straight Edge (outset by thickness)&quot;</span>
    <span class="n">positive</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="OutSetEdge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.OutSetEdge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span></div></div>


<span class="c1">#############################################################################</span>
<span class="c1">####     GroovedEdge</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="GroovedSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GroovedSettings">[docs]</a><span class="k">class</span> <span class="nc">GroovedSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings for Grooved Edge</span>
<span class="sd">Values:</span>

<span class="sd">* absolute_params</span>

<span class="sd"> * style : &quot;arc&quot; : the style of grooves</span>
<span class="sd"> * tri_angle : 30 : the angle of triangular cuts</span>
<span class="sd"> * arc_angle : 120 : the angle of arc cuts</span>
<span class="sd"> * width : 0.2 : the width of each groove (fraction of the edge length)</span>
<span class="sd"> * gap : 0.1 : the gap between grooves (fraction of the edge length)</span>
<span class="sd"> * margin : 0.3 : minimum space left and right without grooves (fraction of the edge length)</span>
<span class="sd"> * inverse : False : invert the groove directions</span>
<span class="sd"> * interleave : False : alternate the direction of grooves</span>
<span class="sd">&quot;&quot;&quot;</span>

    <span class="n">PARAM_ARC</span> <span class="o">=</span> <span class="s2">&quot;arc&quot;</span>
    <span class="n">PARAM_FLAT</span> <span class="o">=</span> <span class="s2">&quot;flat&quot;</span>
    <span class="n">PARAM_SOFTARC</span> <span class="o">=</span> <span class="s2">&quot;softarc&quot;</span>
    <span class="n">PARAM_TRIANGLE</span> <span class="o">=</span> <span class="s2">&quot;triangle&quot;</span>

    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">PARAM_ARC</span><span class="p">,</span> <span class="n">PARAM_FLAT</span><span class="p">,</span> <span class="n">PARAM_TRIANGLE</span><span class="p">,</span> <span class="n">PARAM_SOFTARC</span><span class="p">),</span>
        <span class="s2">&quot;tri_angle&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
        <span class="s2">&quot;arc_angle&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
        <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
        <span class="s2">&quot;gap&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">&quot;margin&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
        <span class="s2">&quot;inverse&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;interleave&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="GroovedSettings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GroovedSettings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="s2">&quot;zZ&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">GroovedEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">GroovedEdgeCounterPart</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GroovedEdgeBase"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GroovedEdgeBase">[docs]</a><span class="k">class</span> <span class="nc">GroovedEdgeBase</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
<div class="viewcode-block" id="GroovedEdgeBase.is_inverse"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GroovedEdgeBase.is_inverse">[docs]</a>    <span class="k">def</span> <span class="nf">is_inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">inverse</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span></div>


<div class="viewcode-block" id="GroovedEdgeBase.groove_arc"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GroovedEdgeBase.groove_arc">[docs]</a>    <span class="k">def</span> <span class="nf">groove_arc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">inv</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="n">side_length</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="o">-</span><span class="n">angle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="n">angle</span><span class="p">,</span> <span class="n">side_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="n">angle</span><span class="p">,</span> <span class="n">side_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="o">-</span><span class="n">angle</span><span class="p">)</span></div>


<div class="viewcode-block" id="GroovedEdgeBase.groove_soft_arc"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GroovedEdgeBase.groove_soft_arc">[docs]</a>    <span class="k">def</span> <span class="nf">groove_soft_arc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">inv</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="n">side_length</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="o">-</span><span class="n">angle</span><span class="p">,</span> <span class="n">side_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="n">angle</span><span class="p">,</span> <span class="n">side_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="n">angle</span><span class="p">,</span> <span class="n">side_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="o">-</span><span class="n">angle</span><span class="p">,</span> <span class="n">side_length</span><span class="p">)</span></div>


<div class="viewcode-block" id="GroovedEdgeBase.groove_triangle"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GroovedEdgeBase.groove_triangle">[docs]</a>    <span class="k">def</span> <span class="nf">groove_triangle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">inv</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="n">side_length</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="o">-</span><span class="n">angle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">side_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">angle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">side_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">inv</span> <span class="o">*</span> <span class="o">-</span><span class="n">angle</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">def</span> <span class="nf">check_bounds</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">mn</span><span class="p">,</span> <span class="n">mx</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">mn</span> <span class="o">&lt;=</span> <span class="n">val</span> <span class="o">&lt;=</span> <span class="n">mx</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> needs to be in [</span><span class="si">{</span><span class="n">mn</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">mx</span><span class="si">}</span><span class="s2">] but is </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">style</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">width</span>
        <span class="n">margin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">margin</span>
        <span class="n">gap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">gap</span>
        <span class="n">interleave</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">interleave</span>

        <span class="n">check_bounds</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">)</span>
        <span class="n">check_bounds</span><span class="p">(</span><span class="n">margin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;margin&quot;</span><span class="p">)</span>
        <span class="n">check_bounds</span><span class="p">(</span><span class="n">gap</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;gap&quot;</span><span class="p">)</span>

        <span class="c1"># Check how many grooves fit</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">margin</span> <span class="o">+</span> <span class="n">gap</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">width</span> <span class="o">+</span> <span class="n">gap</span><span class="p">)))</span>
        <span class="n">inside_width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span> <span class="o">*</span> <span class="p">(</span><span class="n">width</span> <span class="o">+</span> <span class="n">gap</span><span class="p">)</span> <span class="o">-</span> <span class="n">gap</span><span class="p">)</span>
        <span class="n">margin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">inside_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="c1"># Convert to actual length</span>
        <span class="n">margin</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">margin</span>
        <span class="n">gap</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">gap</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">width</span>

        <span class="c1"># Determine the initial inversion</span>
        <span class="n">inv</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_inverse</span><span class="p">()</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">interleave</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">inverse</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">inv</span> <span class="o">=</span> <span class="o">-</span><span class="n">inv</span>

        <span class="c1"># The edge until the first groove</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">margin</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Grooves</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">gap</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">interleave</span><span class="p">:</span>
                    <span class="n">inv</span> <span class="o">=</span> <span class="o">-</span><span class="n">inv</span>
            <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="n">GroovedSettings</span><span class="o">.</span><span class="n">PARAM_FLAT</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="n">GroovedSettings</span><span class="o">.</span><span class="n">PARAM_ARC</span><span class="p">:</span>
                <span class="n">angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">arc_angle</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">groove_arc</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">inv</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="n">GroovedSettings</span><span class="o">.</span><span class="n">PARAM_SOFTARC</span><span class="p">:</span>
                <span class="n">angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">arc_angle</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">groove_soft_arc</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">inv</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="n">GroovedSettings</span><span class="o">.</span><span class="n">PARAM_TRIANGLE</span><span class="p">:</span>
                <span class="n">angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">tri_angle</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">groove_triangle</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">inv</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown GroovedEdge style: </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">style</span><span class="p">)</span>

        <span class="c1"># The final edge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">margin</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="GroovedEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GroovedEdge">[docs]</a><span class="k">class</span> <span class="nc">GroovedEdge</span><span class="p">(</span><span class="n">GroovedEdgeBase</span><span class="p">):</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Edge with grooves&quot;&quot;&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;z&#39;</span>
    <span class="n">inverse</span> <span class="o">=</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="GroovedEdgeCounterPart"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GroovedEdgeCounterPart">[docs]</a><span class="k">class</span> <span class="nc">GroovedEdgeCounterPart</span><span class="p">(</span><span class="n">GroovedEdgeBase</span><span class="p">):</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Edge with grooves (opposing side)&quot;&quot;&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;Z&#39;</span>
    <span class="n">inverse</span> <span class="o">=</span> <span class="kc">True</span></div>


<span class="c1">#############################################################################</span>
<span class="c1">####     Gripping Edge</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="GripSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GripSettings">[docs]</a><span class="k">class</span> <span class="nc">GripSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings for GrippingEdge</span>
<span class="sd">Values:</span>

<span class="sd">* absolute_params</span>

<span class="sd"> * style : &quot;wave : &quot;wave&quot; or &quot;bumps&quot;</span>
<span class="sd"> * outset : True : extend outward the straight edge</span>

<span class="sd">* relative (in multiples of thickness)</span>

<span class="sd"> * depth : 0.3 : depth of the grooves</span>

<span class="sd">&quot;&quot;&quot;</span>

    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;wave&quot;</span><span class="p">,</span> <span class="s2">&quot;bumps&quot;</span><span class="p">),</span>
        <span class="s2">&quot;outset&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;depth&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="GripSettings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GripSettings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">GrippingEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="GrippingEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GrippingEdge">[docs]</a><span class="k">class</span> <span class="nc">GrippingEdge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Corrugated edge useful as an gipping area&quot;&quot;&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span>

<div class="viewcode-block" id="GrippingEdge.wave"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GrippingEdge.wave">[docs]</a>    <span class="k">def</span> <span class="nf">wave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="n">depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">grooves</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length</span> <span class="o">//</span> <span class="p">(</span><span class="n">depth</span> <span class="o">*</span> <span class="mf">2.0</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">depth</span> <span class="o">=</span> <span class="n">length</span> <span class="o">/</span> <span class="n">grooves</span> <span class="o">/</span> <span class="mf">4.0</span>

        <span class="n">o</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">groove</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">grooves</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">o</span> <span class="o">*</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">depth</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">o</span> <span class="o">*</span> <span class="mi">180</span><span class="p">,</span> <span class="n">depth</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">o</span> <span class="o">*</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">depth</span><span class="p">)</span></div>

<div class="viewcode-block" id="GrippingEdge.bumps"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GrippingEdge.bumps">[docs]</a>    <span class="k">def</span> <span class="nf">bumps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="n">depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">grooves</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length</span> <span class="o">//</span> <span class="p">(</span><span class="n">depth</span> <span class="o">*</span> <span class="mf">2.0</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">depth</span> <span class="o">=</span> <span class="n">length</span> <span class="o">/</span> <span class="n">grooves</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="n">o</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">groove</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">grooves</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="n">depth</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span></div>

<div class="viewcode-block" id="GrippingEdge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GrippingEdge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">depth</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span><span class="p">)(</span><span class="n">length</span><span class="p">)</span></div>


<div class="viewcode-block" id="CompoundEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.CompoundEdge">[docs]</a><span class="k">class</span> <span class="nc">CompoundEdge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge composed of multiple different Edges&quot;&quot;&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Compound Edge&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">types</span><span class="p">,</span> <span class="n">lengths</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CompoundEdge</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="n">edge</span><span class="p">)</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">types</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lengths</span> <span class="o">=</span> <span class="n">lengths</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>

<div class="viewcode-block" id="CompoundEdge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.CompoundEdge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startwidth</span><span class="p">()</span></div>

<div class="viewcode-block" id="CompoundEdge.endwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.CompoundEdge.endwidth">[docs]</a>    <span class="k">def</span> <span class="nf">endwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endwidth</span><span class="p">()</span></div>

<div class="viewcode-block" id="CompoundEdge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.CompoundEdge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">((</span><span class="n">e</span><span class="o">.</span><span class="n">margin</span><span class="p">()</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="n">startwidth</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">))</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startwidth</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">length</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1E-5</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wrong length for CompoundEdge&quot;</span><span class="p">)</span>
        <span class="n">lastwidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startwidth</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">types</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengths</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">startwidth</span><span class="p">()</span> <span class="o">-</span> <span class="n">lastwidth</span><span class="p">)</span>
            <span class="n">e</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
            <span class="n">lastwidth</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">endwidth</span><span class="p">()</span></div>


<span class="c1">#############################################################################</span>
<span class="c1">####     Slots</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="Slot"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Slot">[docs]</a><span class="k">class</span> <span class="nc">Slot</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge with an slot to slid another pice through &quot;&quot;&quot;</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Slot&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Slot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">=</span> <span class="n">depth</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span></div>


<div class="viewcode-block" id="SlottedEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlottedEdge">[docs]</a><span class="k">class</span> <span class="nc">SlottedEdge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge with multiple slots&quot;&quot;&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Straight Edge with slots&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">sections</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SlottedEdge</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">Settings</span><span class="p">(</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="n">edge</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="n">sections</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slots</span> <span class="o">=</span> <span class="n">slots</span>

<div class="viewcode-block" id="SlottedEdge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlottedEdge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">startwidth</span><span class="p">()</span></div>

<div class="viewcode-block" id="SlottedEdge.endwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlottedEdge.endwidth">[docs]</a>    <span class="k">def</span> <span class="nf">endwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">endwidth</span><span class="p">()</span></div>

<div class="viewcode-block" id="SlottedEdge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlottedEdge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="o">.</span><span class="n">margin</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">slots</span><span class="p">:</span>
                <span class="n">Slot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">slots</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span></div>


<span class="c1">#############################################################################</span>
<span class="c1">####     Finger Joints</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="FingerJointSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerJointSettings">[docs]</a><span class="k">class</span> <span class="nc">FingerJointSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings for Finger Joints</span>

<span class="sd">Values:</span>

<span class="sd">* absolute</span>
<span class="sd">  * style : &quot;rectangular&quot; : style of the fingers</span>
<span class="sd">  * surroundingspaces : 2 : manimal space at the start and end in multiple of normal spaces</span>
<span class="sd">  * angle: 90 : Angle of the walls meeting</span>

<span class="sd">* relative (in multiples of thickness)</span>

<span class="sd">  * space : 2.0 : space between fingers (multiples of thickness)</span>
<span class="sd">  * finger : 2.0 : width of the fingers (multiples of thickness)</span>
<span class="sd">  * width : 1.0 : width of finger holes (multiples of thickness)</span>
<span class="sd">  * edge_width : 1.0 : space below holes of FingerHoleEdge (multiples of thickness)</span>
<span class="sd">  * play : 0.0 : extra space to allow finger move in and out (multiples of thickness)</span>
<span class="sd">  * extra_length : 0.0 : extra material to grind away burn marks (multiples of thickness)</span>
<span class="sd">&quot;&quot;&quot;</span>

    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;style&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;rectangular&quot;</span><span class="p">,</span> <span class="s2">&quot;springs&quot;</span><span class="p">),</span>
        <span class="s2">&quot;surroundingspaces&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="s2">&quot;angle&quot;</span> <span class="p">:</span> <span class="mf">90.0</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;space&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="s2">&quot;finger&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">&quot;edge_width&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">&quot;play&quot;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s2">&quot;extra_length&quot;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="FingerJointSettings.checkValues"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerJointSettings.checkValues">[docs]</a>    <span class="k">def</span> <span class="nf">checkValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">space</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">finger</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;FingerJointSettings: space + finger must not be close to zero&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="FingerJointSettings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerJointSettings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="s2">&quot;fFh&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">FingerJointEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">FingerJointEdgeCounterPart</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">FingerHoleEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="FingerJointBase"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerJointBase">[docs]</a><span class="k">class</span> <span class="nc">FingerJointBase</span><span class="p">:</span>

<div class="viewcode-block" id="FingerJointBase.calcFingers"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerJointBase.calcFingers">[docs]</a>    <span class="k">def</span> <span class="nf">calcFingers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">bedBolts</span><span class="p">):</span>
        <span class="n">space</span><span class="p">,</span> <span class="n">finger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">space</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">finger</span>
        <span class="n">fingers</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">length</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">surroundingspaces</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">space</span><span class="p">)</span> <span class="o">//</span>
                      <span class="p">(</span><span class="n">space</span> <span class="o">+</span> <span class="n">finger</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">finger</span><span class="p">:</span>
            <span class="n">fingers</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">bedBolts</span><span class="p">:</span>
            <span class="n">fingers</span> <span class="o">=</span> <span class="n">bedBolts</span><span class="o">.</span><span class="n">numFingers</span><span class="p">(</span><span class="n">fingers</span><span class="p">)</span>
        <span class="n">leftover</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="n">fingers</span> <span class="o">*</span> <span class="p">(</span><span class="n">space</span> <span class="o">+</span> <span class="n">finger</span><span class="p">)</span> <span class="o">+</span> <span class="n">space</span>

        <span class="k">if</span> <span class="n">fingers</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fingers</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">leftover</span> <span class="o">=</span> <span class="n">length</span>

        <span class="k">return</span> <span class="n">fingers</span><span class="p">,</span> <span class="n">leftover</span></div>

<div class="viewcode-block" id="FingerJointBase.fingerLength"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerJointBase.fingerLength">[docs]</a>    <span class="k">def</span> <span class="nf">fingerLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
        <span class="c1"># sharp corners</span>
        <span class="k">if</span> <span class="n">angle</span> <span class="o">&gt;=</span><span class="mi">90</span> <span class="ow">or</span> <span class="n">angle</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">90</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">extra_length</span><span class="p">,</span> <span class="mi">0</span>

        <span class="c1"># inner blunt corners</span>
        <span class="k">if</span> <span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="o">-</span><span class="n">angle</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span> <span class="o">+</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">extra_length</span><span class="p">),</span> <span class="mi">0</span>

        <span class="c1"># 0 to 90 (blunt corners)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="p">(</span><span class="mi">180</span><span class="o">-</span><span class="n">angle</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="n">fingerlength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mi">90</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span>
        <span class="n">spacerecess</span> <span class="o">=</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="o">*</span> <span class="n">fingerlength</span>
        <span class="k">return</span> <span class="n">fingerlength</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">extra_length</span><span class="p">,</span> <span class="n">spacerecess</span></div></div>

<div class="viewcode-block" id="FingerJointEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerJointEdge">[docs]</a><span class="k">class</span> <span class="nc">FingerJointEdge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">,</span> <span class="n">FingerJointBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Finger joint edge &quot;&quot;&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Finger Joint&quot;</span>
    <span class="n">positive</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">bedBolts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bedBoltSettings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>

        <span class="n">positive</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive</span>

        <span class="n">s</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">thickness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">space</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">finger</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>

        <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">positive</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">fingers</span><span class="p">,</span> <span class="n">leftover</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calcFingers</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">bedBolts</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">positive</span><span class="p">:</span>
            <span class="n">play</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">play</span>
            <span class="n">f</span> <span class="o">+=</span> <span class="n">play</span>
            <span class="n">s</span> <span class="o">-=</span> <span class="n">play</span>
            <span class="n">leftover</span> <span class="o">-=</span> <span class="n">play</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">leftover</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">l1</span><span class="p">,</span><span class="n">l2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fingerLength</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">l1</span><span class="o">-</span><span class="n">l2</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">bedBoltSettings</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bedBoltSettings</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fingers</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">positive</span> <span class="ow">and</span> <span class="n">bedBolts</span> <span class="ow">and</span> <span class="n">bedBolts</span><span class="o">.</span><span class="n">drawBolt</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">hole</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">s</span><span class="p">,</span>
                              <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">positive</span> <span class="ow">and</span> <span class="n">bedBolts</span> <span class="ow">and</span> <span class="n">bedBolts</span><span class="o">.</span><span class="n">drawBolt</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">bedBoltHole</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">bedBoltSettings</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">positive</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;springs&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span>
                    <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">h</span><span class="p">),</span>
                    <span class="mf">0.1</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span>
                    <span class="n">f</span> <span class="o">-</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">h</span><span class="p">,</span>
                    <span class="mi">90</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">h</span><span class="p">,</span>
                <span class="p">(</span><span class="mi">90</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="mf">0.2</span> <span class="o">*</span><span class="n">h</span><span class="p">),</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">leftover</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<div class="viewcode-block" id="FingerJointEdge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerJointEdge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
        <span class="n">widths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fingerLength</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">widths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">widths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="FingerJointEdge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerJointEdge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">widths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fingerLength</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">widths</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">positive</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="FingerJointEdgeCounterPart"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerJointEdgeCounterPart">[docs]</a><span class="k">class</span> <span class="nc">FingerJointEdgeCounterPart</span><span class="p">(</span><span class="n">FingerJointEdge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Finger joint edge - other side&quot;&quot;&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;F&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Finger Joint (opposing side)&quot;</span>
    <span class="n">positive</span> <span class="o">=</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="FingerHoles"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerHoles">[docs]</a><span class="k">class</span> <span class="nc">FingerHoles</span><span class="p">(</span><span class="n">FingerJointBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Hole matching a finger joint edge&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span> <span class="o">=</span> <span class="n">boxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">boxes</span><span class="o">.</span><span class="n">ctx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">settings</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">bedBolts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bedBoltSettings</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw holes for a matching finger joint edge</span>

<span class="sd">        :param x: position</span>
<span class="sd">        :param y: position</span>
<span class="sd">        :param length: length of matching edge</span>
<span class="sd">        :param angle:  (Default value = 90)</span>
<span class="sd">        :param bedBolts:  (Default value = None)</span>
<span class="sd">        :param bedBoltSettings:  (Default value = None)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">saved_context</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">space</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">finger</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">play</span>
            <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">burn</span>
            <span class="n">fingers</span><span class="p">,</span> <span class="n">leftover</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calcFingers</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">bedBolts</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span>
                                   <span class="n">length</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fingers</span><span class="p">):</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">leftover</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">f</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">bedBolts</span> <span class="ow">and</span> <span class="n">bedBolts</span><span class="o">.</span><span class="n">drawBolt</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">bedBoltSettings</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">bedBoltSettings</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">hole</span><span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">rectangularHole</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                           <span class="n">f</span><span class="o">+</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="n">p</span><span class="p">)</span></div>

<div class="viewcode-block" id="FingerHoleEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerHoleEdge">[docs]</a><span class="k">class</span> <span class="nc">FingerHoleEdge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge with holes for a parallel finger joint&quot;&quot;&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;h&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge (parallel Finger Joint Holes)&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">fingerHoles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fingerHoles</span><span class="p">,</span> <span class="n">Settings</span><span class="p">):</span>
            <span class="n">settings</span> <span class="o">=</span> <span class="n">fingerHoles</span>
            <span class="n">fingerHoles</span> <span class="o">=</span> <span class="n">FingerHoles</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FingerHoleEdge</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fingerHoles</span> <span class="o">=</span> <span class="n">fingerHoles</span> <span class="ow">or</span> <span class="n">boxes</span><span class="o">.</span><span class="n">fingerHolesAt</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">bedBolts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bedBoltSettings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fingerHoles</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">edge_width</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">saved_context</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fingerHoles</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">burn</span> <span class="o">+</span> <span class="n">dist</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">bedBolts</span><span class="o">=</span><span class="n">bedBolts</span><span class="p">,</span> <span class="n">bedBoltSettings</span><span class="o">=</span><span class="n">bedBoltSettings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="FingerHoleEdge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FingerHoleEdge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fingerHoles</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">edge_width</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span></div></div>


<div class="viewcode-block" id="CrossingFingerHoleEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.CrossingFingerHoleEdge">[docs]</a><span class="k">class</span> <span class="nc">CrossingFingerHoleEdge</span><span class="p">(</span><span class="n">Edge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge with holes for finger joints 90° above&quot;&quot;&quot;</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge (orthogonal Finger Joint Holes)&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">fingerHoles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CrossingFingerHoleEdge</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fingerHoles</span> <span class="o">=</span> <span class="n">fingerHoles</span> <span class="ow">or</span> <span class="n">boxes</span><span class="o">.</span><span class="n">fingerHolesAt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fingerHoles</span><span class="p">(</span><span class="n">length</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">burn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CrossingFingerHoleEdge</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">length</span><span class="p">)</span></div>


<span class="c1">#############################################################################</span>
<span class="c1">####     Stackable Joints</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="StackableSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.StackableSettings">[docs]</a><span class="k">class</span> <span class="nc">StackableSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings for Stackable Edges</span>

<span class="sd">Values:</span>

<span class="sd">* absolute_params</span>

<span class="sd">  * angle : 60 : inside angle of the feet</span>

<span class="sd">* relative (in multiples of thickness)</span>

<span class="sd">  * height : 2.0 : height of the feet (multiples of thickness)</span>
<span class="sd">  * width  : 4.0 : width of the feet (multiples of thickness)</span>
<span class="sd">  * holedistance : 1.0 : distance from finger holes to bottom edge (multiples of thickness)</span>

<span class="sd">&quot;&quot;&quot;</span>

    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;angle&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
        <span class="s2">&quot;holedistance&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="StackableSettings.checkValues"><a class="viewcode-back" href="../../boxes.html#boxes.edges.StackableSettings.checkValues">[docs]</a>    <span class="k">def</span> <span class="nf">checkValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;StackableSettings: &#39;angle&#39; is too small. Use value &gt;= 20&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">&gt;</span> <span class="mi">260</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;StackableSettings: &#39;angle&#39; is too big. Use value &lt; 260&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="StackableSettings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.StackableSettings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="s2">&quot;sSš&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fingersettings</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">fingersettings</span> <span class="o">=</span> <span class="n">fingersettings</span> <span class="ow">or</span> <span class="n">boxes</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">settings</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">StackableEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">fingersettings</span><span class="p">),</span>
                 <span class="n">StackableEdgeTop</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">fingersettings</span><span class="p">),</span>
                 <span class="n">StackableFeet</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">fingersettings</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="StackableBaseEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.StackableBaseEdge">[docs]</a><span class="k">class</span> <span class="nc">StackableBaseEdge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge for having stackable Boxes. The Edge creates feet on the bottom</span>
<span class="sd">    and has matching recesses on the top corners.&quot;&quot;&quot;</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Abstract Stackable class&quot;</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="n">fingerjointsettings</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fingerjointsettings</span> <span class="o">=</span> <span class="n">fingerjointsettings</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">angle</span><span class="p">)))</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">angle</span><span class="p">))</span>
        <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="n">p</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">l</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="n">p</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">holedistance</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>

<div class="viewcode-block" id="StackableBaseEdge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.StackableBaseEdge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom</span> <span class="k">else</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="StackableBaseEdge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.StackableBaseEdge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">height</span></div></div>

<div class="viewcode-block" id="StackableEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.StackableEdge">[docs]</a><span class="k">class</span> <span class="nc">StackableEdge</span><span class="p">(</span><span class="n">StackableBaseEdge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge for having stackable Boxes. The Edge creates feet on the bottom</span>
<span class="sd">    and has matching recesses on the top corners.&quot;&quot;&quot;</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Stackable (bottom, finger joint holes)&quot;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">fingerHolesAt</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="n">s</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="n">holedistance</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span><span class="p">,</span>
            <span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span></div>

<div class="viewcode-block" id="StackableEdgeTop"><a class="viewcode-back" href="../../boxes.html#boxes.edges.StackableEdgeTop">[docs]</a><span class="k">class</span> <span class="nc">StackableEdgeTop</span><span class="p">(</span><span class="n">StackableBaseEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;S&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Stackable (top)&quot;</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="StackableFeet"><a class="viewcode-back" href="../../boxes.html#boxes.edges.StackableFeet">[docs]</a><span class="k">class</span> <span class="nc">StackableFeet</span><span class="p">(</span><span class="n">StackableBaseEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;š&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Stackable feet (bottom)&quot;</span>

    <span class="k">def</span> <span class="nf">_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">height</span></div>

<span class="c1">#############################################################################</span>
<span class="c1">####     Hinges</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="HingeSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.HingeSettings">[docs]</a><span class="k">class</span> <span class="nc">HingeSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings for Hinges and HingePins</span>
<span class="sd">Values:</span>

<span class="sd">* absolute_params</span>

<span class="sd"> * style : &quot;outset&quot; : &quot;outset&quot; or &quot;flush&quot;</span>
<span class="sd"> * outset : False : have lid overlap at the sides (similar to OutSetEdge)</span>
<span class="sd"> * pinwidth : 1.0 : set to lower value to get disks surrounding the pins</span>
<span class="sd"> * grip_percentage&quot; : 0 : percentage of the lid that should get grips</span>

<span class="sd">* relative (in multiples of thickness)</span>

<span class="sd"> * hingestrength : 1 : thickness of the arc holding the pin in place (multiples of thickness)</span>
<span class="sd"> * axle : 2 : diameter of the pin hole (multiples of thickness)</span>
<span class="sd"> * grip_length : 0 : fixed length of the grips on he lids (multiples of thickness)</span>

<span class="sd">&quot;&quot;&quot;</span>
    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;style&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;outset&quot;</span><span class="p">,</span> <span class="s2">&quot;flush&quot;</span><span class="p">),</span>
        <span class="s2">&quot;outset&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;pinwidth&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;grip_percentage&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;hingestrength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># 1.5-0.5*2**0.5,</span>
        <span class="s2">&quot;axle&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;grip_length&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="HingeSettings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.HingeSettings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="s2">&quot;iIjJkK&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Hinge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">HingePin</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">Hinge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="n">HingePin</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="n">Hinge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="n">HingePin</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Hinge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Hinge">[docs]</a><span class="k">class</span> <span class="nc">Hinge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;i&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Straight edge with hinge eye&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Hinge</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">layout</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;layout must be 1, 2 or 3 (got </span><span class="si">%i</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;eijk&quot;</span><span class="p">[</span><span class="n">layout</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39; (start)&#39;</span><span class="p">,</span> <span class="s1">&#39; (end)&#39;</span><span class="p">,</span> <span class="s1">&#39; (both ends)&#39;</span><span class="p">)[</span><span class="n">layout</span><span class="p">]</span>

<div class="viewcode-block" id="Hinge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Hinge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span></div>

<div class="viewcode-block" id="Hinge.outset"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Hinge.outset">[docs]</a>    <span class="k">def</span> <span class="nf">outset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_reversed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">r</span><span class="p">))</span>
        <span class="n">pinl</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pinwidth</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> <span class="o">*</span> <span class="n">r</span>
        <span class="n">hinge</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="mi">90</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="o">-</span><span class="mi">360</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span>
            <span class="mi">90</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">,</span>
            <span class="n">t</span><span class="p">,</span>
            <span class="mi">90</span><span class="p">,</span>
            <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
            <span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="n">t</span> <span class="o">+</span> <span class="n">pos</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span> <span class="mi">0</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">_reversed</span><span class="p">:</span>
            <span class="n">hinge</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">hinge</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">hinge</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">rectangularHole</span><span class="p">(</span><span class="o">-</span><span class="n">pos</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span> <span class="n">pinl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">rectangularHole</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span> <span class="n">pinl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">hinge</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hinge.outsetlen"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Hinge.outsetlen">[docs]</a>    <span class="k">def</span> <span class="nf">outsetlen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">r</span><span class="p">))</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> <span class="o">*</span> <span class="n">r</span>

        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pos</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">t</span></div>

<div class="viewcode-block" id="Hinge.flush"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Hinge.flush">[docs]</a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_reversed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>

        <span class="n">hinge</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
            <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
            <span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hingestrength</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">),</span> <span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hingestrength</span>
        <span class="n">pinl</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pinwidth</span>

        <span class="k">if</span> <span class="n">_reversed</span><span class="p">:</span>
            <span class="n">hinge</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">hinge</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hole</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">pos</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">rectangularHole</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">pos</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span> <span class="n">pinl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hole</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">rectangularHole</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span> <span class="n">pinl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">hinge</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hinge.flushlen"><a class="viewcode-back" href="../../boxes.html#boxes.edges.Hinge.flushlen">[docs]</a>    <span class="k">def</span> <span class="nf">flushlen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hingestrength</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">hlen</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span> <span class="o">+</span> <span class="s1">&#39;len&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outsetlen</span><span class="p">)()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outset</span><span class="p">)()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">hlen</span> <span class="o">-</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">&amp;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">hlen</span><span class="p">,</span>
                  <span class="n">tabs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">&amp;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outset</span><span class="p">)(</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="HingePin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.HingePin">[docs]</a><span class="k">class</span> <span class="nc">HingePin</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge with hinge pin&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">HingePin</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">layout</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;layout must be 1, 2 or 3 (got </span><span class="si">%i</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;EIJK&quot;</span><span class="p">[</span><span class="n">layout</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39; (start)&#39;</span><span class="p">,</span> <span class="s1">&#39; (end)&#39;</span><span class="p">,</span> <span class="s1">&#39; (both ends)&#39;</span><span class="p">)[</span><span class="n">layout</span><span class="p">]</span>

<div class="viewcode-block" id="HingePin.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.HingePin.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span></div>

<div class="viewcode-block" id="HingePin.endwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.HingePin.endwidth">[docs]</a>    <span class="k">def</span> <span class="nf">endwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">&amp;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span></div>

<div class="viewcode-block" id="HingePin.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.HingePin.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span></div>

<div class="viewcode-block" id="HingePin.outset"><a class="viewcode-back" href="../../boxes.html#boxes.edges.HingePin.outset">[docs]</a>    <span class="k">def</span> <span class="nf">outset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_reversed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">r</span><span class="p">))</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> <span class="o">*</span> <span class="n">r</span>
        <span class="n">pinl</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pinwidth</span>
        <span class="n">pin</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">pinl</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
               <span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span>
               <span class="n">pinl</span><span class="p">,</span>
               <span class="mi">90</span><span class="p">,</span>
               <span class="n">t</span><span class="p">,</span>
               <span class="o">-</span><span class="mi">90</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span><span class="p">:</span>
            <span class="n">pin</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">pos</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">pinl</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
                <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
                <span class="n">t</span><span class="p">,</span>
                <span class="mi">90</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pin</span> <span class="o">+=</span> <span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">pinl</span><span class="p">,)</span>

        <span class="k">if</span> <span class="n">_reversed</span><span class="p">:</span>
            <span class="n">pin</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">pin</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">pin</span><span class="p">)</span></div>

<div class="viewcode-block" id="HingePin.outsetlen"><a class="viewcode-back" href="../../boxes.html#boxes.edges.HingePin.outsetlen">[docs]</a>    <span class="k">def</span> <span class="nf">outsetlen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">r</span><span class="p">))</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> <span class="o">*</span> <span class="n">r</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pos</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pos</span></div>

<div class="viewcode-block" id="HingePin.flush"><a class="viewcode-back" href="../../boxes.html#boxes.edges.HingePin.flush">[docs]</a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_reversed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">pinl</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pinwidth</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span> <span class="o">-</span> <span class="n">pinl</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="n">pin</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hingestrength</span> <span class="o">+</span> <span class="n">d</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
               <span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span>
               <span class="n">pinl</span><span class="p">,</span>
               <span class="mi">90</span><span class="p">,</span>
               <span class="n">t</span><span class="p">,</span>
               <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span><span class="p">:</span>
            <span class="n">pin</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hingestrength</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
                <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
                <span class="n">t</span><span class="p">,</span>
                <span class="mi">90</span><span class="p">,</span>
                <span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">_reversed</span><span class="p">:</span>
            <span class="n">pin</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">pin</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">pin</span><span class="p">)</span></div>

<div class="viewcode-block" id="HingePin.flushlen"><a class="viewcode-back" href="../../boxes.html#boxes.edges.HingePin.flushlen">[docs]</a>    <span class="k">def</span> <span class="nf">flushlen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hingestrength</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">axle</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hingestrength</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>

        <span class="k">return</span> <span class="n">l</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">plen</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span> <span class="o">+</span> <span class="s1">&#39;len&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outsetlen</span><span class="p">)()</span>
        <span class="n">glen</span> <span class="o">=</span> <span class="n">l</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">grip_percentage</span> <span class="o">+</span> \
               <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">grip_length</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span><span class="p">:</span>
            <span class="n">glen</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">glen</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">glen</span><span class="p">,</span> <span class="n">l</span> <span class="o">-</span> <span class="n">plen</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">&amp;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outset</span><span class="p">)()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">plen</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outset</span><span class="p">)(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outset</span><span class="p">)()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="n">plen</span> <span class="o">-</span> <span class="n">glen</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">](</span><span class="n">glen</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">](</span><span class="n">glen</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="n">plen</span> <span class="o">-</span> <span class="n">glen</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outset</span><span class="p">)(</span><span class="kc">True</span><span class="p">)</span></div>

<span class="c1">#############################################################################</span>
<span class="c1">####     Chest Hinge</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="ChestHingeSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHingeSettings">[docs]</a><span class="k">class</span> <span class="nc">ChestHingeSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings for Chest Hinges</span>
<span class="sd">Values:</span>

<span class="sd">* relative (in multiples of thickness)</span>

<span class="sd"> * pin_height : 2.0 : radius of the disc rotating in the hinge (multiples of thickness)</span>
<span class="sd"> * hinge_strength : 1.0 : thickness of the arc holding the pin in place (multiples of thickness)</span>
<span class="sd">&quot;&quot;&quot;</span>

    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;pin_height&quot;</span> <span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="s2">&quot;hinge_strength&quot;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">&quot;play&quot;</span> <span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="p">}</span>

<div class="viewcode-block" id="ChestHingeSettings.checkValues"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHingeSettings.checkValues">[docs]</a>    <span class="k">def</span> <span class="nf">checkValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin_height</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">thickness</span> <span class="o">&lt;</span> <span class="mf">1.2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ChestHingeSettings: &#39;pin_height&#39; must be &gt;= 1.2&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChestHingeSettings.pinheight"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHingeSettings.pinheight">[docs]</a>    <span class="k">def</span> <span class="nf">pinheight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">((</span><span class="mf">0.9</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pin_height</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">thickness</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span></div>

<div class="viewcode-block" id="ChestHingeSettings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHingeSettings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="s2">&quot;oOpPqQ&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ChestHinge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
            <span class="n">ChestHinge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">ChestHingeTop</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
            <span class="n">ChestHingeTop</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">ChestHingePin</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
            <span class="n">ChestHingeFront</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="ChestHinge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHinge">[docs]</a><span class="k">class</span> <span class="nc">ChestHinge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge with chest hinge&quot;</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">reversed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChestHinge</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reversed</span> <span class="o">=</span> <span class="nb">reversed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;oO&quot;</span><span class="p">[</span><span class="nb">reversed</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; (start)&#39;</span><span class="p">,</span> <span class="s1">&#39; (end)&#39;</span><span class="p">)[</span><span class="nb">reversed</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pin_height</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinge_strength</span>
        <span class="n">pinh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pinheight</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hole</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rectangularHole</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">pinh</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">pinh</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hole</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span><span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rectangularHole</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">s</span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">pinh</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">pinh</span><span class="p">)</span>

        <span class="n">poly</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="mi">270</span><span class="p">,</span> <span class="n">p</span><span class="o">+</span><span class="n">s</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">l</span><span class="o">+</span><span class="n">t</span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="n">s</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed</span><span class="p">:</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">poly</span><span class="p">)</span>

<div class="viewcode-block" id="ChestHinge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHinge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pin_height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinge_strength</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pin_height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinge_strength</span><span class="p">)</span></div>

<div class="viewcode-block" id="ChestHinge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHinge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pin_height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinge_strength</span>
        <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="ChestHinge.endwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHinge.endwidth">[docs]</a>    <span class="k">def</span> <span class="nf">endwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pin_height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinge_strength</span></div></div>

<div class="viewcode-block" id="ChestHingeTop"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHingeTop">[docs]</a><span class="k">class</span> <span class="nc">ChestHingeTop</span><span class="p">(</span><span class="n">ChestHinge</span><span class="p">):</span>

    <span class="s2">&quot;Edge above a chest hinge&quot;</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">reversed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ChestHingeTop</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reversed</span> <span class="o">=</span> <span class="nb">reversed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;oO&quot;</span><span class="p">[</span><span class="nb">reversed</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; (start)&#39;</span><span class="p">,</span> <span class="s1">&#39; (end)&#39;</span><span class="p">)[</span><span class="nb">reversed</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pin_height</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinge_strength</span>
        <span class="n">play</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">play</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">p</span><span class="o">+</span><span class="n">s</span><span class="o">+</span><span class="n">play</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">l</span><span class="o">+</span><span class="n">t</span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="n">s</span><span class="o">-</span><span class="n">play</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed</span><span class="p">:</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">poly</span><span class="p">)</span>

<div class="viewcode-block" id="ChestHingeTop.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHingeTop.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">play</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pin_height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinge_strength</span>
        <span class="k">return</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="ChestHingeTop.endwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHingeTop.endwidth">[docs]</a>    <span class="k">def</span> <span class="nf">endwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">play</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pin_height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinge_strength</span></div>

<div class="viewcode-block" id="ChestHingeTop.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHingeTop.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">play</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pin_height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinge_strength</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="ChestHingePin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHingePin">[docs]</a><span class="k">class</span> <span class="nc">ChestHingePin</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge with pins for an chest hinge&quot;</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;q&quot;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pin_height</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinge_strength</span>
        <span class="n">pinh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pinheight</span><span class="p">()</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">s</span><span class="o">+</span><span class="n">p</span><span class="o">-</span><span class="n">pinh</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">pinh</span><span class="p">,</span> <span class="mi">90</span><span class="p">,]</span>
        <span class="n">poly</span> <span class="o">+=</span> <span class="p">[</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">,]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">poly</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">poly</span><span class="p">)</span>

<div class="viewcode-block" id="ChestHingePin.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHingePin.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pin_height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinge_strength</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ChestHingeFront"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHingeFront">[docs]</a><span class="k">class</span> <span class="nc">ChestHingeFront</span><span class="p">(</span><span class="n">Edge</span><span class="p">):</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge opposing a chest hinge&quot;</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;Q&quot;</span>

<div class="viewcode-block" id="ChestHingeFront.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ChestHingeFront.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pin_height</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinge_strength</span></div></div>

<span class="c1">#############################################################################</span>
<span class="c1">####     Cabinet Hinge</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="CabinetHingeSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.CabinetHingeSettings">[docs]</a><span class="k">class</span> <span class="nc">CabinetHingeSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings for Cabinet Hinges</span>
<span class="sd">Values:</span>

<span class="sd">* absolute_params</span>

<span class="sd"> * bore : 3.2 : diameter of the pin hole in mm</span>
<span class="sd"> * eyes_per_hinge : 5 : pieces per hinge</span>
<span class="sd"> * hinges : 2 : number of hinges per edge</span>
<span class="sd"> * style : inside : style of hinge used</span>

<span class="sd">* relative (in multiples of thickness)</span>

<span class="sd"> * eye : 1.5 : radius of the eye (multiples of thickness)</span>
<span class="sd"> * play : 0.05 : space between eyes (multiples of thickness)</span>
<span class="sd"> * spacing : 2.0 : minimum space around the hinge (multiples of thickness)</span>
<span class="sd">&quot;&quot;&quot;</span>
    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;bore&quot;</span><span class="p">:</span> <span class="mf">3.2</span><span class="p">,</span>
        <span class="s2">&quot;eyes_per_hinge&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s2">&quot;hinges&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;style&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;inside&quot;</span><span class="p">,</span> <span class="s2">&quot;outside&quot;</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;eye&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
        <span class="s2">&quot;play&quot;</span> <span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="s2">&quot;spacing&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="CabinetHingeSettings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.CabinetHingeSettings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="s2">&quot;uUvV&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">CabinetHingeEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">CabinetHingeEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                 <span class="n">CabinetHingeEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">angled</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                 <span class="n">CabinetHingeEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">angled</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">chars</span><span class="p">):</span>
            <span class="n">e</span><span class="o">.</span><span class="n">char</span> <span class="o">=</span> <span class="n">c</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="CabinetHingeEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.CabinetHingeEdge">[docs]</a><span class="k">class</span> <span class="nc">CabinetHingeEdge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge with cabinet hinges&quot;&quot;&quot;</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;u&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge with cabinet hinges&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">angled</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CabinetHingeEdge</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">top</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angled</span> <span class="o">=</span> <span class="n">angled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;uUvV&quot;</span><span class="p">[</span><span class="nb">bool</span><span class="p">(</span><span class="n">top</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="nb">bool</span><span class="p">(</span><span class="n">angled</span><span class="p">)]</span>

<div class="viewcode-block" id="CabinetHingeEdge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.CabinetHingeEdge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">angled</span> <span class="k">else</span> <span class="mf">0.0</span></div>


    <span class="k">def</span> <span class="nf">__poly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">eyes_per_hinge</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">play</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">eye</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">spacing</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;outside&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">angled</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">t</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">angled</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">:</span>
            <span class="c1"># move hinge up to leave space for lid</span>
            <span class="n">e</span> <span class="o">-=</span> <span class="n">t</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">:</span>
            <span class="c1"># start with space</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="p">[</span><span class="n">spacing</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">e</span><span class="o">+</span><span class="n">p</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># start with hinge eye</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="p">[</span><span class="n">spacing</span><span class="o">+</span><span class="n">p</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">e</span><span class="o">+</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">:</span>
                <span class="c1"># space</span>
                <span class="n">poly</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># hinge eye</span>
                <span class="n">poly</span> <span class="o">+=</span> <span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="o">-</span><span class="n">p</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">:</span>
            <span class="c1"># stopped with hinge eye</span>
            <span class="n">poly</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">e</span><span class="o">+</span><span class="n">p</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">p</span><span class="o">+</span><span class="n">spacing</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># stopped with space</span>
            <span class="n">poly</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="n">e</span><span class="o">+</span><span class="n">p</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="o">+</span><span class="n">spacing</span> <span class="p">]</span>

        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">spacing</span>

        <span class="k">return</span> <span class="n">poly</span><span class="p">,</span> <span class="n">width</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">eyes_per_hinge</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">play</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">eye</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">hn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinges</span>

        <span class="n">poly</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__poly</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;outside&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">angled</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">t</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">angled</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">:</span>
            <span class="c1"># move hinge up to leave space for lid</span>
            <span class="n">e</span> <span class="o">-=</span> <span class="n">t</span>

        <span class="n">hn</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">hn</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span> <span class="o">//</span> <span class="n">width</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">hn</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">((</span><span class="n">l</span><span class="o">-</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">hn</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rectangularHole</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">spacing</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">p</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="n">p</span><span class="p">),</span> <span class="n">e</span><span class="o">+</span><span class="mf">2.5</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">poly</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">hn</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">((</span><span class="n">l</span><span class="o">-</span><span class="n">hn</span><span class="o">*</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">hn</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hn</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">((</span><span class="n">l</span><span class="o">-</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="CabinetHingeEdge.parts"><a class="viewcode-back" href="../../boxes.html#boxes.edges.CabinetHingeEdge.parts">[docs]</a>    <span class="k">def</span> <span class="nf">parts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">move</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">e</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">eye</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">bore</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>

        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">eyes_per_hinge</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hinges</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;outside&quot;</span><span class="p">:</span>
            <span class="n">th</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">t</span>
            <span class="n">tw</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">spacing</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">th</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">spacing</span>
            <span class="n">tw</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">pairs</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">tw</span><span class="p">,</span> <span class="n">th</span><span class="p">,</span> <span class="n">move</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;outside&quot;</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">e</span><span class="o">-</span><span class="n">t</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">angled</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">l</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">ax</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">l</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">ax</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">l</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">e</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hole</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">b</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
                <span class="n">da</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">((</span><span class="n">t</span><span class="o">-</span><span class="n">ax</span><span class="p">)</span> <span class="o">/</span> <span class="n">e</span><span class="p">)</span>
                <span class="n">dad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">da</span><span class="p">)</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="n">e</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">da</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">180</span><span class="o">-</span><span class="n">dad</span><span class="p">,</span> <span class="n">e</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="o">+</span><span class="n">dad</span><span class="p">),</span> <span class="n">dy</span><span class="o">+</span><span class="n">l</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span>
                              <span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">l</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">spacing</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">tw</span><span class="p">,</span> <span class="n">th</span><span class="p">,</span> <span class="n">move</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">e</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">angled</span><span class="p">:</span>
                <span class="n">corner</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="o">-</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="n">e</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">e</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">corner</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">e</span><span class="p">)</span>
            <span class="n">ang</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">corner</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">))</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="o">+</span><span class="n">ang</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">180</span><span class="o">-</span><span class="n">ang</span><span class="p">,</span> <span class="n">e</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hole</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">b</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="n">e</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">)]</span> <span class="o">+</span> <span class="n">corner</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">spacing</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">spacing</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">spacing</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="n">tw</span><span class="p">,</span> <span class="n">move</span><span class="p">)</span></div></div>

<span class="c1">#############################################################################</span>
<span class="c1">####     Slide-on lid</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="LidSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidSettings">[docs]</a><span class="k">class</span> <span class="nc">LidSettings</span><span class="p">(</span><span class="n">FingerJointSettings</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Settings for Slide-on Lids</span>

<span class="sd">Note that edge_width below also determines how much the sides extend above the lid.</span>

<span class="sd">Values:</span>

<span class="sd">* absolute_params</span>

<span class="sd"> * second_pin : True : additional pin for better positioning</span>
<span class="sd"> * spring : &quot;both&quot; : position(s) of the extra locking springs in the lid</span>
<span class="sd"> * hole_width : 0 : width of the &quot;finger hole&quot; in mm</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__doc__</span> <span class="o">+=</span> <span class="n">FingerJointSettings</span><span class="o">.</span><span class="vm">__doc__</span>

    <span class="n">absolute_params</span> <span class="o">=</span> <span class="n">FingerJointSettings</span><span class="o">.</span><span class="n">absolute_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">relative_params</span> <span class="o">=</span> <span class="n">FingerJointSettings</span><span class="o">.</span><span class="n">relative_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">relative_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span>
        <span class="s2">&quot;play&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="s2">&quot;finger&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
        <span class="s2">&quot;space&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="p">}</span> <span class="p">)</span>

    <span class="n">absolute_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="p">{</span>
        <span class="s2">&quot;second_pin&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;spring&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">),</span>
        <span class="s2">&quot;hole_width&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span> <span class="p">)</span>

<div class="viewcode-block" id="LidSettings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidSettings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">LidEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">LidHoleEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">LidRight</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">LidLeft</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">LidSideRight</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">LidSideLeft</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="LidEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidEdge">[docs]</a><span class="k">class</span> <span class="nc">LidEdge</span><span class="p">(</span><span class="n">FingerJointEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge for slide on lid (back)&quot;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">bedBolts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bedBoltSettings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">hole_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hole_width</span><span class="p">;</span>
        <span class="k">if</span> <span class="n">hole_width</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">((</span><span class="n">length</span> <span class="o">-</span> <span class="n">hole_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">GroovedEdgeBase</span><span class="o">.</span><span class="n">groove_arc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hole_width</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">((</span><span class="n">length</span> <span class="o">-</span> <span class="n">hole_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">length</span><span class="p">)</span></div>

<div class="viewcode-block" id="LidHoleEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidHoleEdge">[docs]</a><span class="k">class</span> <span class="nc">LidHoleEdge</span><span class="p">(</span><span class="n">FingerHoleEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;L&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge for slide on lid (box back)&quot;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">bedBolts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bedBoltSettings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">hole_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hole_width</span><span class="p">;</span>
        <span class="k">if</span> <span class="n">hole_width</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">((</span><span class="n">length</span> <span class="o">-</span> <span class="n">hole_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">hole_width</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">((</span><span class="n">length</span> <span class="o">-</span> <span class="n">hole_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">length</span><span class="p">)</span></div>

<div class="viewcode-block" id="LidRight"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidRight">[docs]</a><span class="k">class</span> <span class="nc">LidRight</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge for slide on lid (right)&quot;</span>
    <span class="n">rightside</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightside</span><span class="p">:</span>
            <span class="n">spring</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">spring</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">spring</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">spring</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">spring</span><span class="p">:</span>
            <span class="n">l</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">length</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mi">30</span>
            <span class="n">sqt</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
            <span class="n">sw</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span>
            <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">sw</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">l</span><span class="o">-</span><span class="mf">0.2</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">sw</span><span class="p">,</span> <span class="mi">90</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">sqt</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">sqt</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">length</span><span class="o">-</span><span class="n">t</span> <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">length</span><span class="o">-</span><span class="n">t</span><span class="p">]</span>

        <span class="n">pin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">second_pin</span>

        <span class="k">if</span> <span class="n">pin</span><span class="p">:</span>
            <span class="n">pinl</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span>
            <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">length</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">-</span><span class="n">pinl</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">pinl</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightside</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>

<div class="viewcode-block" id="LidRight.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidRight.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightside</span><span class="p">:</span> <span class="c1"># or self.settings.second_pin:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="LidRight.endwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidRight.endwidth">[docs]</a>    <span class="k">def</span> <span class="nf">endwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightside</span><span class="p">:</span> <span class="c1"># or self.settings.second_pin:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="LidRight.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidRight.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightside</span><span class="p">:</span> <span class="c1"># and not self.settings.second_pin:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span></div></div>

<div class="viewcode-block" id="LidLeft"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidLeft">[docs]</a><span class="k">class</span> <span class="nc">LidLeft</span><span class="p">(</span><span class="n">LidRight</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;m&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge for slide on lid (left)&quot;</span>
    <span class="n">rightside</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="LidSideRight"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidSideRight">[docs]</a><span class="k">class</span> <span class="nc">LidSideRight</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;N&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge for slide on lid (box right)&quot;</span>

    <span class="n">rightside</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span>  <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">play</span>
        <span class="n">pin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">second_pin</span>
        <span class="n">edge_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">edge_width</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">edge_width</span><span class="o">/</span><span class="mi">3</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightside</span><span class="p">:</span>
            <span class="n">spring</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">spring</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">spring</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">spring</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">spring</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">edge_width</span><span class="o">-</span><span class="n">s</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">length</span><span class="o">+</span><span class="n">t</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">edge_width</span><span class="o">-</span><span class="n">s</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">length</span><span class="o">+</span><span class="n">t</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">pin</span><span class="p">:</span>
            <span class="n">pinl</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span>
            <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">1.5</span><span class="o">*</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">pinl</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">edge_width</span><span class="o">+</span><span class="n">t</span><span class="o">+</span><span class="n">s</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pinl</span><span class="o">+</span><span class="n">s</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="n">s</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
                      <span class="n">pinl</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">edge_width</span><span class="o">-</span><span class="n">s</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">pinl</span><span class="o">+</span><span class="n">t</span><span class="o">-</span><span class="n">s</span><span class="o">-</span><span class="n">r</span><span class="p">]</span>

        <span class="n">holex</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">t</span>
        <span class="n">holey</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">burn</span> <span class="o">-</span> <span class="n">s</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightside</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
            <span class="n">holex</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="n">holex</span>
            <span class="n">holey</span> <span class="o">=</span> <span class="n">edge_width</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">burn</span>

        <span class="k">if</span> <span class="n">spring</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rectangularHole</span><span class="p">(</span><span class="n">holex</span><span class="p">,</span> <span class="n">holey</span><span class="p">,</span> <span class="mf">0.4</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span>

<div class="viewcode-block" id="LidSideRight.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidSideRight.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">edge_width</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightside</span> <span class="k">else</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">play</span> <span class="o">/</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="LidSideRight.endwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidSideRight.endwidth">[docs]</a>    <span class="k">def</span> <span class="nf">endwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">edge_width</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightside</span> <span class="k">else</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">play</span> <span class="o">/</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="LidSideRight.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidSideRight.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">edge_width</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">play</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightside</span> <span class="k">else</span> <span class="mf">0.0</span></div></div>

<div class="viewcode-block" id="LidSideLeft"><a class="viewcode-back" href="../../boxes.html#boxes.edges.LidSideLeft">[docs]</a><span class="k">class</span> <span class="nc">LidSideLeft</span><span class="p">(</span><span class="n">LidSideRight</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;M&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge for slide on lid (box left)&quot;</span>
    <span class="n">rightside</span> <span class="o">=</span> <span class="kc">False</span></div>

<span class="c1">#############################################################################</span>
<span class="c1">####     Click Joints</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="ClickSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ClickSettings">[docs]</a><span class="k">class</span> <span class="nc">ClickSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings for Click-on Lids</span>
<span class="sd">Values:</span>

<span class="sd">* absolute_params</span>

<span class="sd">  * angle : 5.0 : angle of the hooks bending outward</span>

<span class="sd">* relative (in multiples of thickness)</span>

<span class="sd">  * depth : 3.0 : length of the hooks (multiples of thickness)</span>
<span class="sd">  * bottom_radius : 0.1 : radius at the bottom (multiples of thickness)</span>
<span class="sd">&quot;&quot;&quot;</span>

    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;angle&quot;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;depth&quot;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
        <span class="s2">&quot;bottom_radius&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="ClickSettings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ClickSettings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="s2">&quot;cC&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">ClickConnector</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">ClickEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="ClickConnector"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ClickConnector">[docs]</a><span class="k">class</span> <span class="nc">ClickConnector</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Click on (bottom side)&quot;</span>

<div class="viewcode-block" id="ClickConnector.hook"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ClickConnector.hook">[docs]</a>    <span class="k">def</span> <span class="nf">hook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">angle</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">bottom_radius</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

        <span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span> <span class="o">*</span> <span class="n">d</span><span class="p">)</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">d</span> <span class="o">+</span> <span class="n">t</span><span class="p">,</span>
            <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
            <span class="n">t</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span>
            <span class="mi">135</span><span class="p">,</span>
            <span class="n">t</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">,</span>
            <span class="mi">135</span><span class="p">,</span>
            <span class="n">d</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">s</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">p3</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">d</span> <span class="o">-</span> <span class="n">s</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">reverse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">p1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">p2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">p3</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="nb">reversed</span><span class="p">(</span><span class="n">p3</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="nb">reversed</span><span class="p">(</span><span class="n">p2</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="nb">reversed</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span></div>

<div class="viewcode-block" id="ClickConnector.hookWidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ClickConnector.hookWidth">[docs]</a>    <span class="k">def</span> <span class="nf">hookWidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">angle</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">bottom_radius</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">s</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">r</span></div>

<div class="viewcode-block" id="ClickConnector.hookOffset"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ClickConnector.hookOffset">[docs]</a>    <span class="k">def</span> <span class="nf">hookOffset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">angle</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">depth</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">bottom_radius</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">s</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r</span></div>

<div class="viewcode-block" id="ClickConnector.finger"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ClickConnector.finger">[docs]</a>    <span class="k">def</span> <span class="nf">finger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
            <span class="mi">90</span><span class="p">,</span>
            <span class="n">length</span><span class="p">,</span>
            <span class="mi">90</span><span class="p">,</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span>
        <span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hook</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finger</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hook</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">hookWidth</span><span class="p">()),</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hook</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finger</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hook</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

<div class="viewcode-block" id="ClickConnector.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ClickConnector.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span></div></div>


<div class="viewcode-block" id="ClickEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ClickEdge">[docs]</a><span class="k">class</span> <span class="nc">ClickEdge</span><span class="p">(</span><span class="n">ClickConnector</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Click on (top)&quot;</span>

<div class="viewcode-block" id="ClickEdge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ClickEdge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">thickness</span></div>

<div class="viewcode-block" id="ClickEdge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.ClickEdge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hookOffset</span><span class="p">()</span>
        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hookWidth</span><span class="p">()</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">4</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">o</span><span class="p">,</span>
            <span class="mi">90</span><span class="p">,</span>
            <span class="n">t</span><span class="p">,</span>
            <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">w</span> <span class="o">-</span> <span class="n">o</span><span class="p">),</span>
            <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
            <span class="n">t</span><span class="p">,</span>
            <span class="mi">90</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">p1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">o</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="nb">reversed</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span></div>


<span class="c1">#############################################################################</span>
<span class="c1">####     Dove Tail Joints</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="DoveTailSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.DoveTailSettings">[docs]</a><span class="k">class</span> <span class="nc">DoveTailSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings for Dove Tail Joints</span>

<span class="sd">Values:</span>

<span class="sd">* absolute</span>

<span class="sd">  * angle : 50 : how much should fingers widen (-80 to 80)</span>

<span class="sd">* relative (in multiples of thickness)</span>

<span class="sd">  * size : 3 : from one middle of a dove tail to another (multiples of thickness)</span>
<span class="sd">  * depth : 1.5 : how far the dove tails stick out of/into the edge (multiples of thickness)</span>
<span class="sd">  * radius : 0.2 : radius used on all four corners (multiples of thickness)</span>

<span class="sd">&quot;&quot;&quot;</span>
    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;angle&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;depth&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
        <span class="s2">&quot;radius&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="DoveTailSettings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.DoveTailSettings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="s2">&quot;dD&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">DoveTailJoint</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">DoveTailJointCounterPart</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="DoveTailJoint"><a class="viewcode-back" href="../../boxes.html#boxes.edges.DoveTailJoint">[docs]</a><span class="k">class</span> <span class="nc">DoveTailJoint</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge with dove tail joints &quot;&quot;&quot;</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Dove Tail Joint&quot;</span>
    <span class="n">positive</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">burn</span><span class="p">)</span>  <span class="c1"># no smaller than burn</span>
        <span class="n">positive</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positive</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">angle</span> <span class="o">+</span> <span class="mi">90</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">angle</span> <span class="o">/</span> <span class="mf">180.0</span>

        <span class="n">l1</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="n">diffx</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">depth</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">l2</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">depth</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

        <span class="n">sections</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">length</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">leftover</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="n">sections</span> <span class="o">*</span> <span class="n">s</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="n">sections</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">positive</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">((</span><span class="n">s</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="n">leftover</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="n">diffx</span> <span class="o">-</span> <span class="n">l1</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sections</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">l2</span> <span class="o">-</span> <span class="n">l1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">diffx</span> <span class="o">-</span> <span class="n">l1</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">l2</span> <span class="o">-</span> <span class="n">l1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">p</span> <span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">sections</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># all but the last</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">diffx</span> <span class="o">-</span> <span class="n">l1</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">((</span><span class="n">s</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="n">leftover</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="n">diffx</span> <span class="o">-</span> <span class="n">l1</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<div class="viewcode-block" id="DoveTailJoint.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.DoveTailJoint.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">depth</span></div></div>


<div class="viewcode-block" id="DoveTailJointCounterPart"><a class="viewcode-back" href="../../boxes.html#boxes.edges.DoveTailJointCounterPart">[docs]</a><span class="k">class</span> <span class="nc">DoveTailJointCounterPart</span><span class="p">(</span><span class="n">DoveTailJoint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge for other side of dove joints &quot;&quot;&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;D&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Dove Tail Joint (opposing side)&quot;</span>

    <span class="n">positive</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="DoveTailJointCounterPart.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.DoveTailJointCounterPart.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.0</span></div></div>


<div class="viewcode-block" id="FlexSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FlexSettings">[docs]</a><span class="k">class</span> <span class="nc">FlexSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Settings for Flex</span>

<span class="sd">Values:</span>

<span class="sd">* absolute</span>

<span class="sd"> * stretch : 1.05 : Hint of how much the flex part should be shortend</span>

<span class="sd">* relative (in multiples of thickness)</span>

<span class="sd"> * distance : 0.5 : width of the pattern perpendicular to the cuts (multiples of thickness)</span>
<span class="sd"> * connection : 1.0 : width of the gaps in the cuts (multiples of thickness)</span>
<span class="sd"> * width : 5.0 : width of the pattern in direction of the cuts (multiples of thickness)</span>

<span class="sd">&quot;&quot;&quot;</span>
    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;distance&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;connection&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;stretch&quot;</span><span class="p">:</span> <span class="mf">1.05</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="FlexSettings.checkValues"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FlexSettings.checkValues">[docs]</a>    <span class="k">def</span> <span class="nf">checkValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Flex Settings: distance parameter must be &gt; 0.01mm&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Flex Settings: width parameter must be &gt; 0.1mm&quot;</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="FlexEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.FlexEdge">[docs]</a><span class="k">class</span> <span class="nc">FlexEdge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge with flex cuts - use straight edge for the opposing side&quot;&quot;&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Flex cut&quot;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">distance</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">connection</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">width</span>

        <span class="n">burn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">burn</span>
        <span class="n">h</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">burn</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span> <span class="o">//</span> <span class="n">dist</span><span class="p">)</span>
        <span class="n">leftover</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">lines</span> <span class="o">*</span> <span class="n">dist</span>
        <span class="n">sections</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">h</span> <span class="o">-</span> <span class="n">connection</span><span class="p">)</span> <span class="o">//</span> <span class="n">width</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">sheight</span> <span class="o">=</span> <span class="p">((</span><span class="n">h</span> <span class="o">-</span> <span class="n">connection</span><span class="p">)</span> <span class="o">/</span> <span class="n">sections</span><span class="p">)</span> <span class="o">-</span> <span class="n">connection</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">stroke</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">dist</span> <span class="o">+</span> <span class="n">leftover</span> <span class="o">/</span> <span class="mi">2</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">line_to</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">connection</span> <span class="o">+</span> <span class="n">sheight</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="n">sections</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sheight</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">connection</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">line_to</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">sheight</span> <span class="o">+</span> <span class="n">connection</span><span class="p">))</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">sections</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">h</span> <span class="o">-</span> <span class="n">sheight</span> <span class="o">-</span> <span class="n">connection</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">line_to</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sections</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">line_to</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">h</span> <span class="o">-</span> <span class="n">connection</span> <span class="o">-</span> <span class="n">sheight</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="n">sections</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span>
                            <span class="n">pos</span><span class="p">,</span> <span class="n">h</span> <span class="o">-</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">sheight</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">connection</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">line_to</span><span class="p">(</span>
                            <span class="n">pos</span><span class="p">,</span> <span class="n">h</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">sheight</span> <span class="o">+</span> <span class="n">connection</span><span class="p">))</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sections</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span>
                                         <span class="n">h</span> <span class="o">-</span> <span class="n">connection</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">sheight</span> <span class="o">+</span> <span class="n">connection</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">line_to</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">h</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">sheight</span> <span class="o">+</span> <span class="n">connection</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">stroke</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">move_to</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">line_to</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">get_current_point</span><span class="p">())</span></div>

<div class="viewcode-block" id="GearSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.GearSettings">[docs]</a><span class="k">class</span> <span class="nc">GearSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Settings for rack (and pinion) edge</span>
<span class="sd">Values:</span>
<span class="sd">* absolute_params</span>

<span class="sd"> * dimension : 3.0 : modulus of the gear (in mm)</span>
<span class="sd"> * angle : 20.0 : pressure angle</span>
<span class="sd"> * profile_shift : 20.0 : Profile shift</span>
<span class="sd"> * clearance : 0.0 : clearance</span>
<span class="sd">&quot;&quot;&quot;</span>

    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;dimension&quot;</span> <span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span>
        <span class="s2">&quot;angle&quot;</span> <span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span>
        <span class="s2">&quot;profile_shift&quot;</span> <span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span>
        <span class="s2">&quot;clearance&quot;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="RackEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.RackEdge">[docs]</a><span class="k">class</span> <span class="nc">RackEdge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;R&quot;</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Rack (and pinion) Edge&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RackEdge</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gear</span> <span class="o">=</span> <span class="n">gears</span><span class="o">.</span><span class="n">Gears</span><span class="p">(</span><span class="n">boxes</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;draw_rack&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;rack_base_height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1E-36</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;rack_teeth_length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length</span> <span class="o">//</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;dimension&quot;</span><span class="p">])</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;rack_base_tab&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;rack_teeth_length&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;dimension&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="n">s_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">spacing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gear</span><span class="p">(</span><span class="n">move</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="n">s_tmp</span>

<div class="viewcode-block" id="RackEdge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.RackEdge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">dimension</span> <span class="o">*</span> <span class="mf">1.1</span></div></div>

<div class="viewcode-block" id="RoundedTriangleEdgeSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.RoundedTriangleEdgeSettings">[docs]</a><span class="k">class</span> <span class="nc">RoundedTriangleEdgeSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Settings for RoundedTriangleEdge</span>
<span class="sd">Values:</span>

<span class="sd">* absolute_params</span>

<span class="sd"> * height : 150. : height above the wall</span>
<span class="sd"> * radius : 30. : radius of top corner</span>
<span class="sd"> * r_hole : 0. : radius of hole</span>

<span class="sd">* relative (in multiples of thickness)</span>

<span class="sd"> * outset : 0 : extend the triangle along the length of the edge (multiples of thickness)</span>

<span class="sd">&quot;&quot;&quot;</span>

    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;height&quot;</span> <span class="p">:</span> <span class="mf">150.</span><span class="p">,</span>
        <span class="s2">&quot;radius&quot;</span> <span class="p">:</span> <span class="mf">30.</span><span class="p">,</span>
        <span class="s2">&quot;r_hole&quot;</span> <span class="p">:</span> <span class="mf">2.</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;outset&quot;</span> <span class="p">:</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="RoundedTriangleEdgeSettings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.RoundedTriangleEdgeSettings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">RoundedTriangleEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">RoundedTriangleFingerHolesEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="RoundedTriangleEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.RoundedTriangleEdge">[docs]</a><span class="k">class</span> <span class="nc">RoundedTriangleEdge</span><span class="p">(</span><span class="n">Edge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Makes an &#39;edge&#39; with a rounded triangular bumpout and</span>
<span class="sd">       optional hole&quot;&quot;&quot;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Triangle for handle&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;t&quot;</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">length</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">radius</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span>  <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">length</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">height</span><span class="p">:</span> <span class="c1"># avoid division by zero</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="mi">90</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span>
                <span class="p">(</span><span class="n">length</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">height</span><span class="p">)))</span>
            <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span><span class="o">-</span><span class="n">angle</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span>
                <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">height</span><span class="o">/</span><span class="p">(</span><span class="n">length</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)))</span>
            <span class="n">l</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">length</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">r_hole</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hole</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">length</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">r_hole</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="mi">90</span><span class="o">-</span><span class="n">angle</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">angle</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="mi">90</span><span class="o">-</span><span class="n">angle</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">outset</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">)</span>

<div class="viewcode-block" id="RoundedTriangleEdge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.RoundedTriangleEdge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">radius</span></div></div>

<div class="viewcode-block" id="RoundedTriangleFingerHolesEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.RoundedTriangleFingerHolesEdge">[docs]</a><span class="k">class</span> <span class="nc">RoundedTriangleFingerHolesEdge</span><span class="p">(</span><span class="n">RoundedTriangleEdge</span><span class="p">):</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;T&quot;</span>

<div class="viewcode-block" id="RoundedTriangleFingerHolesEdge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.RoundedTriangleFingerHolesEdge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fingerHolesAt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span></div>

<span class="c1">#############################################################################</span>
<span class="c1">####     Slat wall</span>
<span class="c1">#############################################################################</span>

<div class="viewcode-block" id="SlatWallSettings"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallSettings">[docs]</a><span class="k">class</span> <span class="nc">SlatWallSettings</span><span class="p">(</span><span class="n">Settings</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Settings for SlatWallEdges</span>
<span class="sd">Values:</span>

<span class="sd">* absolute_params</span>

<span class="sd"> * bottom_hook : &quot;hook&quot; : &quot;spring&quot;, &quot;stud&quot; or &quot;none&quot;</span>
<span class="sd"> * pitch : 101.6 : vertical spacing of slots middle to middle (in mm)</span>
<span class="sd"> * hook_depth : 4.0 : horizontal width of the hook</span>

<span class="sd">* relative (in multiples of thickness)</span>

<span class="sd"> * hook_extra_height : 2.0 : space surrounding connectors (multiples of thickness)</span>
<span class="sd"> * edge_width : 1.0 : space below holes of FingerHoleEdge (multiples of thickness)</span>

<span class="sd">&quot;&quot;&quot;</span>

    <span class="n">absolute_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;bottom_hook&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="s2">&quot;hook&quot;</span><span class="p">,</span> <span class="s2">&quot;spring&quot;</span><span class="p">,</span> <span class="s2">&quot;stud&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">),</span>
        <span class="s2">&quot;pitch&quot;</span> <span class="p">:</span> <span class="mf">101.6</span><span class="p">,</span>
        <span class="s2">&quot;hook_depth&quot;</span> <span class="p">:</span> <span class="mf">4.0</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">relative_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;hook_extra_height&quot;</span> <span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="s2">&quot;edge_width&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="SlatWallSettings.edgeObjects"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallSettings.edgeObjects">[docs]</a>    <span class="k">def</span> <span class="nf">edgeObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="s2">&quot;aAbBcCdD&quot;</span><span class="p">,</span> <span class="n">add</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="n">SlatWallEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">SlatWallEdgeReversed</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">SlatWallJoinedEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">SlatWallJoinedEdgeReversed</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">SlatWallBackEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">SlatWallBackEdgeReversed</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">SlatWallHoleEdge</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
                 <span class="n">SlatWallHoleEdgeReversed</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgeObjects</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">chars</span><span class="p">,</span> <span class="n">add</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SlatWallEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallEdge">[docs]</a><span class="k">class</span> <span class="nc">SlatWallEdge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>
    <span class="n">reversed_</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_top_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reversed_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mi">6</span> <span class="c1"># vertical width of hook</span>
        <span class="n">hd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_depth</span>
        <span class="n">ro</span> <span class="o">=</span> <span class="mi">6</span> <span class="c1"># outer radius</span>
        <span class="n">ri</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># inner radius</span>
        <span class="n">rt</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">hd</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># top radius</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mf">5.5</span><span class="o">-</span><span class="n">ri</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">ri</span><span class="p">),</span> <span class="mi">12</span><span class="o">-</span><span class="n">ri</span><span class="o">-</span><span class="n">w</span><span class="o">-</span><span class="n">rt</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">rt</span><span class="p">),</span>
                <span class="n">hd</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">rt</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">rt</span><span class="p">),</span> <span class="mi">12</span><span class="o">-</span><span class="n">ro</span><span class="o">-</span><span class="n">rt</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">ro</span><span class="p">),</span> <span class="mf">5.5</span><span class="o">+</span><span class="n">hd</span><span class="o">-</span><span class="n">ro</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_extra_height</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">reversed_</span><span class="p">:</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">poly</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_top_hook_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_extra_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_bottom_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reversed_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">slot</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="n">hd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_depth</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">bottom_hook</span> <span class="o">==</span> <span class="s2">&quot;spring&quot;</span><span class="p">:</span>
            <span class="n">r_plug</span> <span class="o">=</span> <span class="n">slot</span><span class="o">*</span><span class="mf">.4</span>
            <span class="n">slotslot</span> <span class="o">=</span> <span class="n">slot</span> <span class="o">-</span> <span class="n">r_plug</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_extra_height</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
                    <span class="mf">5.0</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">135</span><span class="p">,</span> <span class="n">r_plug</span><span class="p">),</span>
                    <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">slotslot</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="p">(</span><span class="mi">135</span><span class="p">,</span> <span class="n">r_plug</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_extra_height</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">bottom_hook</span> <span class="o">==</span> <span class="s2">&quot;hook&quot;</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_extra_height</span> <span class="o">+</span> <span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
                    <span class="mf">4.5</span><span class="o">+</span><span class="n">hd</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">slot</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hd</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>
                    <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_extra_height</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">bottom_hook</span> <span class="o">==</span> <span class="s2">&quot;stud&quot;</span><span class="p">:</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_extra_height</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
                    <span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">,</span> <span class="n">slot</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_extra_height</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_extra_height</span> <span class="o">+</span> <span class="n">slot</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">reversed_</span><span class="p">:</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="o">*</span><span class="n">poly</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_bottom_hook_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">slot</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">slot</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_extra_height</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hook_extra_height</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_joint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">reversed_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">pitch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">pitch</span>
        <span class="n">tht</span><span class="p">,</span> <span class="n">thb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top_hook_len</span><span class="p">()</span>
        <span class="n">bht</span><span class="p">,</span> <span class="n">bhb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bottom_hook_len</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">length</span> <span class="o">&gt;=</span> <span class="n">pitch</span> <span class="o">+</span> <span class="n">tht</span> <span class="o">+</span> <span class="n">bhb</span> <span class="ow">and</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">bottom_hook</span> <span class="o">!=</span> <span class="s2">&quot;none&quot;</span><span class="p">):</span>
            <span class="n">top_len</span> <span class="o">=</span> <span class="p">((</span><span class="n">length</span><span class="o">-</span><span class="n">tht</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">pitch</span><span class="p">)</span> <span class="o">*</span> <span class="n">pitch</span> <span class="o">-</span> <span class="n">thb</span> <span class="o">-</span> <span class="n">bht</span>
            <span class="n">bottom_len</span> <span class="o">=</span> <span class="p">(</span><span class="n">length</span><span class="o">-</span><span class="n">tht</span><span class="p">)</span> <span class="o">%</span> <span class="n">pitch</span> <span class="o">-</span> <span class="n">bhb</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">top_len</span> <span class="o">=</span> <span class="n">length</span><span class="o">-</span><span class="n">tht</span><span class="o">-</span><span class="n">thb</span>
            <span class="n">bottom_len</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed_</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bottom_len</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_joint</span><span class="p">(</span><span class="n">bottom_len</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_bottom_hook</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_joint</span><span class="p">(</span><span class="n">top_len</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_top_hook</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_top_hook</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_joint</span><span class="p">(</span><span class="n">top_len</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bottom_len</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_bottom_hook</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_joint</span><span class="p">(</span><span class="n">bottom_len</span><span class="p">)</span>

<div class="viewcode-block" id="SlatWallEdge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallEdge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">6</span><span class="o">+</span><span class="mf">5.5</span></div></div>

<div class="viewcode-block" id="SlatWallEdgeReversed"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallEdgeReversed">[docs]</a><span class="k">class</span> <span class="nc">SlatWallEdgeReversed</span><span class="p">(</span><span class="n">SlatWallEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span>
    <span class="n">reversed_</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="SlatWallJoinedEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallJoinedEdge">[docs]</a><span class="k">class</span> <span class="nc">SlatWallJoinedEdge</span><span class="p">(</span><span class="n">SlatWallEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;b&quot;</span>

    <span class="k">def</span> <span class="nf">_joint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">reversed_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s2">&quot;f&quot;</span><span class="p">](</span><span class="n">length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>

<div class="viewcode-block" id="SlatWallJoinedEdge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallJoinedEdge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span></div></div>

<div class="viewcode-block" id="SlatWallJoinedEdgeReversed"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallJoinedEdgeReversed">[docs]</a><span class="k">class</span> <span class="nc">SlatWallJoinedEdgeReversed</span><span class="p">(</span><span class="n">SlatWallJoinedEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;B&quot;</span>
    <span class="n">reversed_</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="SlatWallBackEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallBackEdge">[docs]</a><span class="k">class</span> <span class="nc">SlatWallBackEdge</span><span class="p">(</span><span class="n">SlatWallEdge</span><span class="p">):</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span>

    <span class="k">def</span> <span class="nf">_top_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reversed_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_top_hook_len</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">_bottom_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reversed_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bottom_hook_len</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">_joint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">reversed_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">](</span><span class="n">length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polyline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">)</span>

<div class="viewcode-block" id="SlatWallBackEdge.margin"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallBackEdge.margin">[docs]</a>    <span class="k">def</span> <span class="nf">margin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span></div></div>

<div class="viewcode-block" id="SlatWallBackEdgeReversed"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallBackEdgeReversed">[docs]</a><span class="k">class</span> <span class="nc">SlatWallBackEdgeReversed</span><span class="p">(</span><span class="n">SlatWallBackEdge</span><span class="p">):</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
    <span class="n">reversed_</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="SlatWallHoles"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallHoles">[docs]</a><span class="k">class</span> <span class="nc">SlatWallHoles</span><span class="p">(</span><span class="n">SlatWallEdge</span><span class="p">):</span>

    <span class="n">reversed_</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_top_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reversed_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_top_hook_len</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rectangularHole</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_bottom_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reversed_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bottom_hook_len</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rectangularHole</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_joint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">reversed_</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fingerHolesAt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw holes for a matching SlatWallJoinedEdge</span>

<span class="sd">        :param x: position</span>
<span class="sd">        :param y: position</span>
<span class="sd">        :param length: length of matching edge</span>
<span class="sd">        :param angle:  (Default value = 90)</span>
<span class="sd">        :param bedBolts:  (Default value = None)</span>
<span class="sd">        :param bedBoltSettings:  (Default value = None)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">saved_context</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">moveTo</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">burn</span>
            <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span> <span class="c1"># XXX</span>
                <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ctx</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span>
                                   <span class="n">length</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">b</span><span class="p">,</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>

            <span class="n">SlatWallEdge</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span></div>

<div class="viewcode-block" id="SlatWallHoleEdge"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallHoleEdge">[docs]</a><span class="k">class</span> <span class="nc">SlatWallHoleEdge</span><span class="p">(</span><span class="n">BaseEdge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Edge with holes for a parallel finger joint&quot;&quot;&quot;</span>
    <span class="n">char</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Edge (parallel slot wall Holes)&quot;</span>
    <span class="n">reversed_</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="p">,</span> <span class="n">slatWallHoles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">slatWallHoles</span><span class="p">,</span> <span class="n">Settings</span><span class="p">):</span>
            <span class="n">settings</span> <span class="o">=</span> <span class="n">slatWallHoles</span>
            <span class="n">slatWallHoles</span> <span class="o">=</span> <span class="n">SlatWallHoles</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SlatWallHoleEdge</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">slatWallHoles</span> <span class="o">=</span> <span class="n">slatWallHoles</span> <span class="ow">or</span> <span class="n">boxes</span><span class="o">.</span><span class="n">slatWallHolesAt</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">bedBolts</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bedBoltSettings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slatWallHoles</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">edge_width</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">saved_context</span><span class="p">():</span>
            <span class="n">px</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reversed_</span> <span class="k">else</span> <span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slatWallHoles</span><span class="p">(</span>
                <span class="n">px</span><span class="p">,</span> <span class="n">dist</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="SlatWallHoleEdge.startwidth"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallHoleEdge.startwidth">[docs]</a>    <span class="k">def</span> <span class="nf">startwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">slatWallHoles</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">edge_width</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">thickness</span></div></div>

<div class="viewcode-block" id="SlatWallHoleEdgeReversed"><a class="viewcode-back" href="../../boxes.html#boxes.edges.SlatWallHoleEdgeReversed">[docs]</a><span class="k">class</span> <span class="nc">SlatWallHoleEdgeReversed</span><span class="p">(</span><span class="n">SlatWallHoleEdge</span><span class="p">):</span>

    <span class="n">char</span> <span class="o">=</span> <span class="s2">&quot;D&quot;</span>
    <span class="n">reversed_</span> <span class="o">=</span> <span class="kc">True</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/boxes-logo.svg" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">boxes.py 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../boxes.html" >boxes</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">boxes.edges</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Florian Festi.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.2.
    </div>
  </body>
</html>